<html>
<head>
<title>QUnit basic example</title>
<!--
<meta http-equiv="refresh" content="2">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.js"></script>
<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
<script type="text/javascript">
jQuery.query = { numbers: false, hash: true };
</script>
<script type="text/javascript" src="./js/jquery.query-2.1.7.js"></script>
<script type="text/javascript" src="./js/searchEvent.js"></script>
<script type="text/javascript" src="./js/searchRakuten.js"></script>
<script type="text/javascript" src="./js/searchJalan.js"></script>
<script type="text/javascript" src="./js/azusaarBase.js"></script>
<script type="text/javascript" src="./js/azusaarPc.js"></script>
<script type="text/javascript" src="./js/holiday.js"></script>
<script type="text/javascript" src="./js/jquery.jsonml.js"></script>
<script type="text/javascript">


</script>
<script type="text/javascript">
var tester = {
	assertContainsString: function(actual, expected){
		ok(actual.indexOf(expected) != -1, "文字が含まれない actual=" + actual + ", expected=" + expected);
	},
};

module("azusaarBase");
test("getRealMonth", function(){
	var date = new Date(2011, 7-1, 7);
	deepEqual(date.getRealMonth(),  7);
});
test("addDate", function(){
	var date = new Date(2011, 7-1, 11);
	var actual = date.addDate(3);
	deepEqual(actual.getDate(), 14);
});
test("addMonth", function(){
	var date = new Date(2011, 7-1, 11);
	var actual = date.addMonth(3);
	deepEqual(actual.getMonth(), 10-1);

	var date = new Date(2011, 12-1, 1);
	var actual = date.addMonth(3);
	deepEqual(actual.getFullYear(), 2012);
	deepEqual(actual.getMonth(), 3-1);

	var date = new Date(2011, 7-1, 11);
	var actual = date.addMonth(-1);
	deepEqual(actual.getMonth(), 6-1);

	var date = new Date(2011, 1-1, 1);
	var actual = date.addMonth(-1);
	deepEqual(actual.getFullYear(), 2010);
	deepEqual(actual.getMonth(), 12-1);

	var date = new Date(2012, 1-1, 30, 19, 30, 0);
	var actual = date.addMonth(1);
	deepEqual(actual.getFullYear(), 2012);
	deepEqual(actual.getMonth(), 2-1);
	deepEqual(actual.getDate(), 29);
});
test("deepEqualMonth", function(){
	var date1 = new Date(2011, 7-1, 1);
	var date2 = new Date(2011, 7-1, 31);
	ok(date1.deepEqualMonth(date2));

	var date1 = new Date(2011, 4-1, 1);
	var date2 = new Date(2011, 7-1, 31);
	ok(!date1.deepEqualMonth(date2));
});

var base = new AzusaarBase();
test("initCalendar", function(){
	base.initCalendar(2011, 8);
	var week2sun = $("#calendar tr.week:eq(1) td:eq(0)").attr("id");
	deepEqual(week2sun, "day7");
	var week6 = $("#calendar tr.week:eq(5)");
	deepEqual(week6.css("display"), "none");
});
test("initCalendar2", function(){
	base.initCalendar(2011, 12);
	var week6 = $("#calendar tr.week:eq(5)");
	deepEqual(week6.css("display"), "none");
});
test("isParam", function(){
	deepEqual(base.isParam("aaa"), true);
	deepEqual(base.isParam(1), true);
	deepEqual(base.isParam(true), false);
	deepEqual(base.isParam(false), false);
});
test("toYYYYMM", function(){
	deepEqual(base.toYYYYMM(2011, 9),  "201109");
	deepEqual(base.toYYYYMM(2011, 10), "201110");
	deepEqual(base.toYYYYMM("2011", "9"),  "201109");
	deepEqual(base.toYYYYMM("2011", "10"), "201110");
});
test("toYYYYMMDD", function(){
	deepEqual(base.toYYYYMMDD(2011, 9, 1),  "20110901");
	deepEqual(base.toYYYYMMDD(2011, 10, 10), "20111010");
	deepEqual(base.toYYYYMMDD("2011", "9", "1"),  "20110901");
	deepEqual(base.toYYYYMMDD("2011", "10", "10"), "20111010");
});
test("parseDate", function(){
	var date = base.parseDate("2011-07-19T19:10:20+09:00");
	deepEqual(date.getFullYear(), 2011);
	deepEqual(date.getMonth(), 7-1);
	deepEqual(date.getDate(), 19);
	deepEqual(date.getHours(), 19);
	deepEqual(date.getMinutes(), 10);
	deepEqual(date.getSeconds(), 20);
})
test("parseDate_eventATND", function(){
	var date = base.parseDate("2012-04-28T19:00:00+09:00");
	deepEqual(date.getFullYear(), 2012);
	deepEqual(date.getMonth(), 4-1);
	deepEqual(date.getDate(), 28);
	deepEqual(date.getHours(), 19);
	deepEqual(date.getMinutes(), 0);
	deepEqual(date.getSeconds(), 0);
})
test("splitKeyword", function(){
	deepEqual(base.splitKeyword(null),  "");
	deepEqual(base.splitKeyword(""),  "");
	deepEqual(base.splitKeyword("Google App Engine"),  ["Google","App","Engine"]);
	deepEqual(base.splitKeyword("Google　App　Engine"),  ["Google","App","Engine"]);
});
test("checkValue", function(){
	deepEqual(base.checkValue("checked"),  "1");
	deepEqual(base.checkValue("unchecked"),  "0");
});
test("trim", function(){
	var str = "ホテル イースト21東京          I LOVE DISCO!!!!!!!!!!!!!  HISTORY OF '70s～NOW(東京都)";
	var expected = "ホテル イースト21東京 I LOVE DISCO!!!!!!!!!!!!! HISTORY OF '70s～NOW(東京都)";
	deepEqual(base.trim(str),  expected);
});
test("createYmds", function(){
	var actual = base.createYmds(2011, 6);
	deepEqual(actual.length, 30);
	deepEqual(actual[0], "20110601")
	deepEqual(actual[29], "20110630")
})

/*
module("azusaarPc");
test("addEvent", function(){
	var e = {
		title: "TEST1",
		event_url: "http://www.google.co.jp/",
		started_at: "2011-07-01T10:30:00+09:00",
	};

	azusaar.addEvent(e, "atnd");

	var actual = $("#day1").text();
	tester.assertContainsString(actual, "TEST1");
});
*/

module("searchRakuten");
test("searchBase", function(){
	var hotelCount = 0;
	var finishCount = 0;
	rakuten.searchBase(35.6655089, 139.7545959, function(){
		hotelCount++;
	}, function(){
		finishCount++;
	});
	stop();
	setTimeout(function(){
		ok(hotelCount > 0);
		deepEqual(finishCount, 1);
		start();
	}, 3000);
});

module("searchJalan");
test("searchBase", function(){
	var hotelCount = 0;
	var finishCount = 0;
	jalan.searchBase(35.6655089, 139.7545959, function(){
		hotelCount++;
	}, function(){
		finishCount++;
	});
	stop();
	setTimeout(function(){
		ok(hotelCount > 0);
		deepEqual(finishCount, 1);
		start();
	}, 3000);
});

module("holiday");
test("getHoliday", function(){
	expect(2);

	holiday.getHoliday(2011, 10, function(info){
		deepEqual(info.day, 10);
		deepEqual(info.title, "体育の日");
	});

	stop();
	setTimeout(function(){

		start();
	}, 3000);

});
</script>

<!--
<script type="text/javascript" src="./js/azusaarSmart.js"></script>
 -->
<script type="text/javascript">
/*
module("atnd");
test("searchDaily", function(){
	atnd.searchDaily("テスト", 2011, 6, 7);
	stop();
	setTimeout(function(){
		//deepEqual(atnd.totalResultCount, 1);
		ok(atnd.totalResultCount > 0);
		start();
	}, 10000);
});
*/

$.mobile = {};
$.mobile.showPageLoadingMsg = function(){};

module("atnd");
test("search", function(){
	atnd.search("テスト", 2011, 6);
	stop();
	setTimeout(function(){
		//deepEqual(atnd.totalResultCount, 1);
		ok(atnd.totalResultCount > 0);
		start();
	}, 10000);
})
module("zusaar");
zusaar.apiUrl = "/api/zusaar";
test("search", function(){
	zusaar.search("appengine", 2011, 7);
	stop();
	setTimeout(function(){
		//deepEqual(zusaar.totalResultCount, 2);
		ok(zusaar.totalResultCount > 0);
		start();
	}, 10000);
})
module("kokucheese");
kokucheese.apiUrl = "/api/kokucheese";
test("search", function(){
	kokucheese.search("", 2012, 1);
	stop();
	setTimeout(function(){
		//deepEqual(kokucheese.totalResultCount, 10);
		ok(kokucheese.totalResultCount > 0);
		start();
	}, 10000);
})
module("partake");
partake.apiUrl = "/api/partake";
test("search", function(){
	partake.search("", 2012, 1);
	stop();
	setTimeout(function(){
		//deepEqual(kokucheese.totalResultCount, 10);
		ok(partake.totalResultCount > 0);
		start();
	}, 10000);
})
</script>

<!--
<script type="text/javascript" src="./js/azusaarSmart.js"></script>
<script type="text/javascript">

module("azusaarSmart");
test("formatDate", function(){

	var date = new Date(2011, 8-1, 5, 19, 30, 0);
	var actual = azusaar.formatDate(date);

	deepEqual(actual, "8/5");
});

</script>
 -->


<link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css" media="screen" />
</head>
<body>
<h1 id="qunit-header">QUnit AZusaar UnitTest</h1>
<h2 id="qunit-banner"></h2>
<div id="qunit-testrunner-toolbar"></div>
<h2 id="qunit-userAgent"></h2>
<ol id="qunit-tests"></ol>
<div id="qunit-fixture">test markup, will be hidden</div>
<div id="main"></div>

<input type="checkbox" id="checked" checked="checked"/>
<input type="checkbox" id="unchecked"/>

<form id="searchForm" action="./index.html">
	<input id="beforeMonth" type="button" value="<">
	<input id="afterMonth" type="button" value=">">
	<input id="thisMonth" type="button" value="today">
	<input id="query" type="text" name="query" value="aaaaa"/>
	<input type="submit" name="search" value="Search"/>
</form>
<table id="calendar" border="1">
<tr class="header">
	<th>日</th>
	<th>月</th>
	<th>火</th>
	<th>水</th>
	<th>木</th>
	<th>金</th>
	<th>土</th>
</tr>
<tr class="week">
	<td id="11"></td>
	<td id="12"></td>
	<td id="13"></td>
	<td id="14"></td>
	<td id="15"></td>
	<td id="16"></td>
	<td id="17"></td>
</tr>
<tr class="week">
	<td id="21"></td>
	<td id="22"></td>
	<td id="23"></td>
	<td id="24"></td>
	<td id="25"></td>
	<td id="26"></td>
	<td id="27"></td>
</tr>
<tr class="week">
	<td id="31"></td>
	<td id="32"></td>
	<td id="33"></td>
	<td id="34"></td>
	<td id="35"></td>
	<td id="36"></td>
	<td id="37"></td>
</tr>
<tr class="week">
	<td id="41"></td>
	<td id="42"></td>
	<td id="43"></td>
	<td id="44"></td>
	<td id="45"></td>
	<td id="46"></td>
	<td id="47"></td>
</tr>
<tr class="week">
	<td id="51"></td>
	<td id="52"></td>
	<td id="53"></td>
	<td id="54"></td>
	<td id="55"></td>
	<td id="56"></td>
	<td id="57"></td>
</tr>
<tr class="week">
	<td id="61"></td>
	<td id="62"></td>
	<td id="63"></td>
	<td id="64"></td>
	<td id="65"></td>
	<td id="66"></td>
	<td id="67"></td>
</tr>
</table>

</body>
</html>
